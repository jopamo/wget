# Lighttpd configuration for wget tests
server.document-root = "@DOCROOT@"
server.port = @PORT@
server.bind = "127.0.0.1"

# Enable range request support
server.range-requests = "enable"

# Logging (minimal for tests)
server.errorlog = "@TMPDIR@/lighttpd.error.log"
accesslog.filename = "@TMPDIR@/lighttpd.access.log"

# MIME types
mimetype.assign = (
  ".html" => "text/html",
  ".txt" => "text/plain",
  ".json" => "application/json",
  ".css" => "text/css",
  ".js" => "application/javascript",
  ".png" => "image/png",
  ".jpg" => "image/jpeg",
  ".gif" => "image/gif",
  ".svg" => "image/svg+xml"
)

# Directory listing disabled
dir-listing.activate = "disable"

# Server tag (hide for cleaner tests)
server.tag = ""

# Keep connections alive for better performance
server.max-keep-alive-requests = 16
server.max-keep-alive-idle = 5

# URL redirect configuration for testing
url.redirect = (
    # Single 302 redirect
    "^/redirect-302$" => "/hello.txt",
    # Multiple redirect chain
    "^/redirect-chain-1$" => "/redirect-chain-2",
    "^/redirect-chain-2$" => "/redirect-chain-3",
    "^/redirect-chain-3$" => "/hello.txt",
    # 302 with body (lighttpd doesn't support body with redirects, so we'll handle this differently)
)

# Custom redirect handler for redirect-with-body
$HTTP["url"] =~ "^/redirect-with-body$" {
    server.error-handler-404 = "/redirect-with-body-handler"
}